

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Package Reference &mdash; dstc7-noesis 0.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Submission" href="submission.html" />
    <link rel="prev" title="FAQs" href="faq.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> dstc7-noesis
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluations.html">Evaluations</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Package Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-noesis.networks.dual_encoder">Networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-noesis.dataset.dataset">Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-noesis.trainers.supervised_trainer">Trainers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-noesis.evaluator.evaluator">Evaluator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-noesis.dataset.vocabulary">Vocabulary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-noesis.dataset.utils">Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-noesis.util.checkpoint">Checkpoint</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="submission.html">Submission</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dstc7-noesis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Package Reference</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/package_reference.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="package-reference">
<h1>Package Reference<a class="headerlink" href="#package-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-noesis.networks.dual_encoder">
<span id="networks"></span><h2>Networks<a class="headerlink" href="#module-noesis.networks.dual_encoder" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="noesis.networks.dual_encoder.Base">
<em class="property">class </em><code class="descclassname">noesis.networks.dual_encoder.</code><code class="descname">Base</code><span class="sig-paren">(</span><em>vocab_size</em>, <em>max_len</em>, <em>hidden_size</em>, <em>input_dropout_p</em>, <em>dropout_p</em>, <em>n_layers</em>, <em>rnn_cell</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/networks/dual_encoder.html#Base"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.networks.dual_encoder.Base" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a multi-layer RNN to an input sequence.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not use this class directly, use one of the sub classes.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vocab_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – size of the vocabulary</li>
<li><strong>max_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – maximum allowed length for the sequence to be processed</li>
<li><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – number of features in the hidden state <cite>h</cite></li>
<li><strong>input_dropout_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – dropout probability for the input sequence</li>
<li><strong>dropout_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – dropout probability for the output sequence</li>
<li><strong>n_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – number of recurrent layers</li>
<li><strong>rnn_cell</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – type of RNN cell (Eg. ‘LSTM’ , ‘GRU’)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: <code class="docutils literal notranslate"><span class="pre">*args</span></code>, <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code></dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">*args</span></code>: variable length argument list.</li>
<li><code class="docutils literal notranslate"><span class="pre">**kwargs</span></code>: arbitrary keyword arguments.</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="noesis.networks.dual_encoder.Base.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/networks/dual_encoder.html#Base.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.networks.dual_encoder.Base.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="noesis.networks.dual_encoder.DualEncoder">
<em class="property">class </em><code class="descclassname">noesis.networks.dual_encoder.</code><code class="descname">DualEncoder</code><span class="sig-paren">(</span><em>context</em>, <em>response</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/networks/dual_encoder.html#DualEncoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.networks.dual_encoder.DualEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>”
Applies dual encoder architecture.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context</strong> (<a class="reference internal" href="#noesis.networks.dual_encoder.Encoder" title="noesis.networks.dual_encoder.Encoder"><em>noesis.networks.dual_encoder.Encoder</em></a>) – encoder RNN for context information</li>
<li><strong>response</strong> (<a class="reference internal" href="#noesis.networks.dual_encoder.Encoder" title="noesis.networks.dual_encoder.Encoder"><em>noesis.networks.dual_encoder.Encoder</em></a>) – encoder RNN for responses information</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: context_var, responses_var</dt>
<dd><ul class="first last simple">
<li><strong>context_var</strong> : a tensor containing context information</li>
<li><strong>responses_var</strong> : a tensor containing responses per context information</li>
</ul>
</dd>
<dt>Outputs: output</dt>
<dd><ul class="first last simple">
<li><strong>output</strong> (batch, num_responses): tensor containing scaled probabilities of responses</li>
</ul>
</dd>
<dt>Examples::</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dual_encoder</span> <span class="o">=</span> <span class="n">DualEncoder</span><span class="p">(</span><span class="n">ctx_encoder</span><span class="p">,</span> <span class="n">resp_encoder</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">dual_encoder</span><span class="p">(</span><span class="n">ctx_variable</span><span class="p">,</span> <span class="n">resp_variable</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="noesis.networks.dual_encoder.DualEncoder.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>context_var</em>, <em>responses_var</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/networks/dual_encoder.html#DualEncoder.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.networks.dual_encoder.DualEncoder.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a multi-layer RNN to an input sequence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>context_var</strong> (<em>batch</em><em>, </em><em>seq_len</em>) – tensor containing the features of the context sequence.</li>
<li><strong>responses_var</strong> (<em>batch</em><em>, </em><em>num_responses</em><em>, </em><em>seq_len</em>) – tensor containing the features of the responses sequence.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns: output</dt>
<dd><ul class="first last simple">
<li><strong>output</strong> (batch, num_responses): variable containing the scaled probabilities over responses</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="noesis.networks.dual_encoder.Encoder">
<em class="property">class </em><code class="descclassname">noesis.networks.dual_encoder.</code><code class="descname">Encoder</code><span class="sig-paren">(</span><em>vocab_size</em>, <em>max_len</em>, <em>hidden_size</em>, <em>input_dropout_p=0</em>, <em>dropout_p=0</em>, <em>n_layers=1</em>, <em>bidirectional=False</em>, <em>rnn_cell='gru'</em>, <em>variable_lengths=False</em>, <em>embedding=None</em>, <em>update_embedding=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/networks/dual_encoder.html#Encoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.networks.dual_encoder.Encoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a multi-layer RNN to an input sequence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vocab_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – size of the vocabulary</li>
<li><strong>max_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – a maximum allowed length for the sequence to be processed</li>
<li><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – the number of features in the hidden state <cite>h</cite></li>
<li><strong>input_dropout_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em>, </em><em>optional</em>) – dropout probability for the input sequence (default: 0)</li>
<li><strong>dropout_p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em>, </em><em>optional</em>) – dropout probability for the output sequence (default: 0)</li>
<li><strong>n_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – number of recurrent layers (default: 1)</li>
<li><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><em>optional</em>) – if True, becomes a bidirectional encodr (defulat False)</li>
<li><strong>rnn_cell</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>, </em><em>optional</em>) – type of RNN cell (default: gru)</li>
<li><strong>variable_lengths</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><em>optional</em>) – if use variable length RNN (default: False)</li>
<li><strong>embedding</strong> (<a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (0.5.0a0+372d1d6 ))"><em>torch.Tensor</em></a><em>, </em><em>optional</em>) – Pre-trained embedding.  The size of the tensor has to match
the size of the embedding parameter: (vocab_size, hidden_size).  The embedding layer would be initialized
with the tensor if provided (default: None).</li>
<li><strong>update_embedding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><em>optional</em>) – If the embedding should be updated during training (default: False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Inputs: inputs, input_lengths</dt>
<dd><ul class="first last simple">
<li><strong>inputs</strong>: list of sequences, whose length is the batch size and within which each sequence is a list of token IDs.</li>
<li><strong>input_lengths</strong> (list of int, optional): list that contains the lengths of sequences in the mini-batch, it must be provided when using variable length RNN (default: <cite>None</cite>)</li>
</ul>
</dd>
<dt>Outputs: output, hidden</dt>
<dd><ul class="first last simple">
<li><strong>output</strong> (batch, seq_len, hidden_size): tensor containing the encoded features of the input sequence</li>
<li><strong>hidden</strong> (num_layers * num_directions, batch, hidden_size): tensor containing the features in the hidden state <cite>h</cite></li>
</ul>
</dd>
<dt>Examples::</dt>
<dd><div class="first last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">encoder</span> <span class="o">=</span> <span class="n">EncoderRNN</span><span class="p">(</span><span class="n">input_vocab</span><span class="p">,</span> <span class="n">max_seq_length</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="p">,</span> <span class="n">hidden</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="method">
<dt id="noesis.networks.dual_encoder.Encoder.forward">
<code class="descname">forward</code><span class="sig-paren">(</span><em>input_var</em>, <em>input_lengths=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/networks/dual_encoder.html#Encoder.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.networks.dual_encoder.Encoder.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a multi-layer RNN to an input sequence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>input_var</strong> (<em>batch</em><em>, </em><em>seq_len</em>) – tensor containing the features of the input sequence.</li>
<li><strong>input_lengths</strong> (<em>list of int</em><em>, </em><em>optional</em>) – A list that contains the lengths of sequences
in the mini-batch</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Returns: output, hidden</dt>
<dd><ul class="first last simple">
<li><strong>output</strong> (batch, seq_len, hidden_size): variable containing the encoded features of the input sequence</li>
<li><strong>hidden</strong> (num_layers * num_directions, batch, hidden_size): variable containing the features in the hidden state h</li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-noesis.dataset.dataset">
<span id="dataset"></span><h2>Dataset<a class="headerlink" href="#module-noesis.dataset.dataset" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="noesis.dataset.dataset.Dataset">
<em class="property">class </em><code class="descclassname">noesis.dataset.dataset.</code><code class="descname">Dataset</code><a class="reference internal" href="_modules/noesis/dataset/dataset.html#Dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.dataset.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that encapsulates a dataset.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not use this constructor directly, use one of the class methods to initialize.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Source or target sequences that are longer than the respective
max length will be filtered.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>max_len</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – maximum source sequence length</td>
</tr>
</tbody>
</table>
<dl class="classmethod">
<dt id="noesis.dataset.dataset.Dataset.from_file">
<em class="property">classmethod </em><code class="descname">from_file</code><span class="sig-paren">(</span><em>path</em>, <em>vocab=None</em>, <em>max_vocab=50000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/dataset.html#Dataset.from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.dataset.Dataset.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a dataset from the file at given path. The file
must contains a list of TAB-separated pairs of sequences.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Source or target sequences that are longer than the respective
max length will be filtered.
As specified by maximum vocabulary size, source and target
vocabularies will be sorted in descending token frequency and cutoff.
Tokens that are in the dataset but not retained in the vocabulary
will be dropped in the sequences.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – path to the dataset file</li>
<li><strong>vocab</strong> (<a class="reference internal" href="#noesis.dataset.vocabulary.Vocabulary" title="noesis.dataset.vocabulary.Vocabulary"><em>Vocabulary</em></a>) – pre-populated Vocabulary object or a path of a file containing words for the source language, default <cite>None</cite>. If a pre-populated Vocabulary object, <cite>src_max_vocab</cite> wouldn’t be used.</li>
<li><strong>max_vocab</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – maximum source vocabulary size</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.dataset.Dataset.make_batches">
<code class="descname">make_batches</code><span class="sig-paren">(</span><em>batch_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/dataset.html#Dataset.make_batches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.dataset.Dataset.make_batches" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a generator that generates batches in batch_size over data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – number of pairs in a mini-batch</td>
</tr>
<tr class="field-even field"><th class="field-name">Yields:</th><td class="field-body"><em>(list (str), list (str))</em> – next pair of source and target variable in a batch</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.dataset.Dataset.num_batches">
<code class="descname">num_batches</code><span class="sig-paren">(</span><em>batch_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/dataset.html#Dataset.num_batches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.dataset.Dataset.num_batches" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of batches given batch size.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – number of examples in a batch</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">number of batches</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)">int</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.dataset.Dataset.shuffle">
<code class="descname">shuffle</code><span class="sig-paren">(</span><em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/dataset.html#Dataset.shuffle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.dataset.Dataset.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Shuffle the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – provide a value for the random seed; default seed=None is truly random</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-noesis.trainers.supervised_trainer">
<span id="trainers"></span><h2>Trainers<a class="headerlink" href="#module-noesis.trainers.supervised_trainer" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="noesis.trainers.supervised_trainer.SupervisedTrainer">
<em class="property">class </em><code class="descclassname">noesis.trainers.supervised_trainer.</code><code class="descname">SupervisedTrainer</code><span class="sig-paren">(</span><em>expt_dir='experiment'</em>, <em>loss_func=CrossEntropyLoss()</em>, <em>batch_size=64</em>, <em>random_seed=None</em>, <em>checkpoint_every=100</em>, <em>print_every=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/trainers/supervised_trainer.html#SupervisedTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.trainers.supervised_trainer.SupervisedTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>The SupervisedTrainer class helps in setting up a training framework in a
supervised setting.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>expt_dir</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – experiment Directory to store details of the experiment,
by default it makes a folder in the current directory to store the details (default: <cite>experiment</cite>).</li>
<li><strong>loss_func</strong> (<a class="reference external" href="https://pytorch.org/docs/master/nn.html#torch.nn.CrossEntropyLoss" title="(in PyTorch vmaster (0.5.0a0+372d1d6 ))"><em>torch.nn.CrossEntropyLoss</em></a><em>, </em><em>optional</em>) – loss for training, (default: torch.nn.CrossEntropyLoss)</li>
<li><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – batch size for experiment, (default: 64)</li>
<li><strong>checkpoint_every</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – number of batches to checkpoint after, (default: 100)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="noesis.trainers.supervised_trainer.SupervisedTrainer.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>model</em>, <em>data</em>, <em>num_epochs=5</em>, <em>resume=False</em>, <em>dev_data=None</em>, <em>optimizer=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/trainers/supervised_trainer.html#SupervisedTrainer.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.trainers.supervised_trainer.SupervisedTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Run training for a given model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<em>models.networks</em>) – model to run training on, if <cite>resume=True</cite>, it would be
overwritten by the model loaded from the latest checkpoint.</li>
<li><strong>data</strong> (<em>models.dataset.dataset.Dataset</em>) – dataset object to train on</li>
<li><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – number of epochs to run (default 5)</li>
<li><strong>resume</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a><em>, </em><em>optional</em>) – resume training with the latest checkpoint, (default False)</li>
<li><strong>dev_data</strong> (<em>models.dataset.dataset.Dataset</em><em>, </em><em>optional</em>) – dev Dataset (default None)</li>
<li><strong>optimizer</strong> (<em>pytorch.optim</em><em>, </em><em>optional</em>) – optimizer for training
(default: Optimizer(pytorch.optim.Adam, max_grad_norm=5))</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-noesis.evaluator.evaluator">
<span id="evaluator"></span><h2>Evaluator<a class="headerlink" href="#module-noesis.evaluator.evaluator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="noesis.evaluator.evaluator.Evaluator">
<em class="property">class </em><code class="descclassname">noesis.evaluator.evaluator.</code><code class="descname">Evaluator</code><span class="sig-paren">(</span><em>loss_func=CrossEntropyLoss()</em>, <em>batch_size=64</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/evaluator/evaluator.html#Evaluator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.evaluator.evaluator.Evaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to evaluate models with given datasets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>loss</strong> (<em>torch.NN.CrossEntropyLoss</em><em>, </em><em>optional</em>) – loss for evaluator (default: torch.NN.CrossEntropyLoss)</li>
<li><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>, </em><em>optional</em>) – batch size for evaluator (default: 64)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="noesis.evaluator.evaluator.Evaluator.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>model</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/evaluator/evaluator.html#Evaluator.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.evaluator.evaluator.Evaluator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a model on given dataset and return performance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>model</strong> (<em>models.networks</em>) – model to evaluate</li>
<li><strong>data</strong> (<a class="reference internal" href="#noesis.dataset.dataset.Dataset" title="noesis.dataset.dataset.Dataset"><em>dataset.dataset.Dataset</em></a>) – dataset to evaluate against</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">loss of the given model on the given dataset</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">loss (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)">float</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-noesis.dataset.vocabulary">
<span id="vocabulary"></span><h2>Vocabulary<a class="headerlink" href="#module-noesis.dataset.vocabulary" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="noesis.dataset.vocabulary.Vocabulary">
<em class="property">class </em><code class="descclassname">noesis.dataset.vocabulary.</code><code class="descname">Vocabulary</code><span class="sig-paren">(</span><em>size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary" title="Permalink to this definition">¶</a></dt>
<dd><p>A Vocabulary stores a set of words belonging to a particular language. Words in the source vocabulary are mapped
to unique integer IDs during encoding. Words in the target vocabulary are recovered from the model’s output
during decoding.
In addition to the words in the actual language, a Vocabulary includes three reserved tokens (and IDs) for the
start-of-sentence and end-of-sentence markers, and for a special ‘mask’ marker used to handle
rare/unknown words.
The Vocabulary is sorted in descending order based on frequency. If the number of words seen is greater than
the maximum size of the Vocabulary, the remaining least-frequent words are ignored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – maximum number of words allowed in this vocabulary</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.add_sequence">
<code class="descname">add_sequence</code><span class="sig-paren">(</span><em>sequence</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.add_sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.add_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a sequence of words to the vocabulary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>)</em>) – list of words, e.g. representing a sentence.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.add_token">
<code class="descname">add_token</code><span class="sig-paren">(</span><em>token</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.add_token"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.add_token" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an occurrence of a token to the vocabulary, incrementing its observed frequency if the word already exists.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>token</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – word to add</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.check_sorted">
<code class="descname">check_sorted</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.check_sorted"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.check_sorted" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts the vocabulary (if it is not already sorted).</p>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.get_index">
<code class="descname">get_index</code><span class="sig-paren">(</span><em>token</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.get_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.get_index" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">ID of the given token.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ID (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)">int</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.get_token">
<code class="descname">get_token</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.get_token"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.get_token" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">token with ID equal to the given index.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">token (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)">str</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.get_vocab_size">
<code class="descname">get_vocab_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.get_vocab_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.get_vocab_size" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">maximum number of words in the vocabulary.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">size (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)">int</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.indices_from_sequence">
<code class="descname">indices_from_sequence</code><span class="sig-paren">(</span><em>sequence</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.indices_from_sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.indices_from_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps a list of words to their token IDs, or else the ‘mask’ token if the word is rare/unknown.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sequence</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a><em>)</em>) – list of words to map</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of mapped IDs</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)">int</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="noesis.dataset.vocabulary.Vocabulary.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>file_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a Vocabulary from a pickle file on disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – path to the pickle file</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">loaded Vocabulary</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#noesis.dataset.vocabulary.Vocabulary" title="noesis.dataset.vocabulary.Vocabulary">Vocabulary</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>file_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes this Vocabulary to disk in a pickle file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – path to the target pickle file</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.sequence_from_indices">
<code class="descname">sequence_from_indices</code><span class="sig-paren">(</span><em>indices</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.sequence_from_indices"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.sequence_from_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Recover a sentence from a list of token IDs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>)</em>) – list of token IDs.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">recovered sentence, represented as a list of words</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)">str</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.dataset.vocabulary.Vocabulary.trim">
<code class="descname">trim</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/vocabulary.html#Vocabulary.trim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.vocabulary.Vocabulary.trim" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts the vocabulary in descending order based on frequency</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-noesis.dataset.utils">
<span id="utilities"></span><h2>Utilities<a class="headerlink" href="#module-noesis.dataset.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="noesis.dataset.utils.prepare_data">
<code class="descclassname">noesis.dataset.utils.</code><code class="descname">prepare_data</code><span class="sig-paren">(</span><em>path</em>, <em>tokenize_func=&lt;function space_tokenize&gt;</em>, <em>format='JSON'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/utils.html#prepare_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.utils.prepare_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a tab-separated data file where each line contains a source sentence and a target sentence. Pairs containing
a sentence that exceeds the maximum length allowed for its language are not added.
:param path: path to the data file
:type path: str
:param tokenize_func: function for splitting words in a sentence (default is single-space-delimited)
:type tokenize_func: func
:param format: data format for input file. Default is JSON.
:type format: str</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of ((context, list of candidates), target) string pairs</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)">list</a>((<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)">str</a>)), <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)">str</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="noesis.dataset.utils.process">
<code class="descclassname">noesis.dataset.utils.</code><code class="descname">process</code><span class="sig-paren">(</span><em>records</em>, <em>tokenize_func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/utils.html#process"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.utils.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="noesis.dataset.utils.read">
<code class="descclassname">noesis.dataset.utils.</code><code class="descname">read</code><span class="sig-paren">(</span><em>fin</em>, <em>delimiter</em>, <em>tokenize_func</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/utils.html#read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.utils.read" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="noesis.dataset.utils.read_vocabulary">
<code class="descclassname">noesis.dataset.utils.</code><code class="descname">read_vocabulary</code><span class="sig-paren">(</span><em>path</em>, <em>max_num_vocab=50000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/utils.html#read_vocabulary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.utils.read_vocabulary" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function to read a vocabulary file.
:param path: filepath to raw vocabulary file
:type path: str
:param max_num_vocab: maximum number of words to read from vocabulary file
:type max_num_vocab: int</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">read words from vocabulary file</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.6)">set</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="noesis.dataset.utils.space_tokenize">
<code class="descclassname">noesis.dataset.utils.</code><code class="descname">space_tokenize</code><span class="sig-paren">(</span><em>text</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/dataset/utils.html#space_tokenize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.dataset.utils.space_tokenize" title="Permalink to this definition">¶</a></dt>
<dd><p>Tokenizes a piece of text by splitting it up based on single spaces (” “).
:param text: input text as a single string
:type text: str</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of tokens obtained by splitting the text on single spaces</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)">str</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-noesis.util.checkpoint">
<span id="checkpoint"></span><h2>Checkpoint<a class="headerlink" href="#module-noesis.util.checkpoint" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="noesis.util.checkpoint.Checkpoint">
<em class="property">class </em><code class="descclassname">noesis.util.checkpoint.</code><code class="descname">Checkpoint</code><span class="sig-paren">(</span><em>model</em>, <em>optimizer</em>, <em>epoch</em>, <em>step</em>, <em>vocab</em>, <em>path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/util/checkpoint.html#Checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.util.checkpoint.Checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>The Checkpoint class manages the saving and loading of a model during training. It allows training to be suspended
and resumed at a later time (e.g. when running on a cluster using sequential jobs).</p>
<p>To make a checkpoint, initialize a Checkpoint object with the following args; then call that object’s save() method
to write parameters to disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<em>seq2seq</em>) – seq2seq model being trained</li>
<li><strong>optimizer</strong> (<em>Optimizer</em>) – stores the state of the optimizer</li>
<li><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – current epoch (an epoch is a loop through the full training data)</li>
<li><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – number of examples seen within the current epoch</li>
<li><strong>vocab</strong> (<a class="reference internal" href="#noesis.dataset.vocabulary.Vocabulary" title="noesis.dataset.vocabulary.Vocabulary"><em>Vocabulary</em></a>) – vocabulary for the input language</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="noesis.util.checkpoint.Checkpoint.CHECKPOINT_DIR_NAME">
<code class="descname">CHECKPOINT_DIR_NAME</code><a class="headerlink" href="#noesis.util.checkpoint.Checkpoint.CHECKPOINT_DIR_NAME" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – name of the checkpoint directory</p>
</dd></dl>

<dl class="attribute">
<dt id="noesis.util.checkpoint.Checkpoint.TRAINER_STATE_NAME">
<code class="descname">TRAINER_STATE_NAME</code><a class="headerlink" href="#noesis.util.checkpoint.Checkpoint.TRAINER_STATE_NAME" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – name of the file storing trainer states</p>
</dd></dl>

<dl class="attribute">
<dt id="noesis.util.checkpoint.Checkpoint.MODEL_NAME">
<code class="descname">MODEL_NAME</code><a class="headerlink" href="#noesis.util.checkpoint.Checkpoint.MODEL_NAME" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – name of the file storing model</p>
</dd></dl>

<dl class="attribute">
<dt id="noesis.util.checkpoint.Checkpoint.VOCAB_FILE">
<code class="descname">VOCAB_FILE</code><a class="headerlink" href="#noesis.util.checkpoint.Checkpoint.VOCAB_FILE" title="Permalink to this definition">¶</a></dt>
<dd><p><em>str</em> – name of the input vocab file</p>
</dd></dl>

<dl class="classmethod">
<dt id="noesis.util.checkpoint.Checkpoint.get_latest_checkpoint">
<em class="property">classmethod </em><code class="descname">get_latest_checkpoint</code><span class="sig-paren">(</span><em>experiment_path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/util/checkpoint.html#Checkpoint.get_latest_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.util.checkpoint.Checkpoint.get_latest_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the path to an experiment directory, returns the path to the last saved checkpoint’s subdirectory.</p>
<p>Precondition: at least one checkpoint has been made (i.e., latest checkpoint subdirectory exists).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>experiment_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – path to the experiment directory</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">path to the last saved checkpoint’s subdirectory</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="noesis.util.checkpoint.Checkpoint.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/util/checkpoint.html#Checkpoint.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.util.checkpoint.Checkpoint.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a Checkpoint object that was previously saved to disk.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – path to the checkpoint subdirectory</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">checkpoint object with fields copied from those stored on disk</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">checkpoint (<a class="reference internal" href="#noesis.util.checkpoint.Checkpoint" title="noesis.util.checkpoint.Checkpoint">Checkpoint</a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="noesis.util.checkpoint.Checkpoint.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>experiment_dir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/noesis/util/checkpoint.html#Checkpoint.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#noesis.util.checkpoint.Checkpoint.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the current model and related training parameters into a subdirectory of the checkpoint directory.
The name of the subdirectory is the current local time in Y_M_D_H_M_S format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>experiment_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – path to the experiment root directory</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">path to the saved checkpoint subdirectory</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="submission.html" class="btn btn-neutral float-right" title="Submission" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="faq.html" class="btn btn-neutral" title="FAQs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, International Business Machines Corp.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>